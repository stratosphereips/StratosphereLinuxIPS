<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Slips: slips.modules.blocking.blocking.Module Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Slips
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>slips</b></li><li class="navelem"><b>modules</b></li><li class="navelem"><b>blocking</b></li><li class="navelem"><b>blocking</b></li><li class="navelem"><a class="el" href="../../d4/dc7/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module.html">Module</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="../../d5/dae/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">slips.modules.blocking.blocking.Module Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for slips.modules.blocking.blocking.Module:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d5a/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module__inherit__graph.png" border="0" usemap="#slips_8modules_8blocking_8blocking_8Module_inherit__map" alt="Inheritance graph"/></div>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for slips.modules.blocking.blocking.Module:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/df9/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module__coll__graph.png" border="0" usemap="#slips_8modules_8blocking_8blocking_8Module_coll__map" alt="Collaboration graph"/></div>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1e379ee42d3b429088a03495ee755bbd"><td class="memItemLeft" align="right" valign="top"><a id="a1e379ee42d3b429088a03495ee755bbd"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>__init__</b> (self, outputqueue, redis_port=6379)</td></tr>
<tr class="separator:a1e379ee42d3b429088a03495ee755bbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdbeb350740b00e84bab990e74c9efba"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc7/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module.html#acdbeb350740b00e84bab990e74c9efba">test</a> (self)</td></tr>
<tr class="separator:acdbeb350740b00e84bab990e74c9efba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa72921bb9ddfbb94a568184a10c07b1e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc7/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module.html#aa72921bb9ddfbb94a568184a10c07b1e">set_sudo_according_to_env</a> (self)</td></tr>
<tr class="separator:aa72921bb9ddfbb94a568184a10c07b1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ebac44a0c55f89230d22ad1a917eb68"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc7/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module.html#a3ebac44a0c55f89230d22ad1a917eb68">print</a> (self, text, verbose=1, debug=0)</td></tr>
<tr class="separator:a3ebac44a0c55f89230d22ad1a917eb68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25a8d6261c2514280dfbb67638bd1c9b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc7/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module.html#a25a8d6261c2514280dfbb67638bd1c9b">determine_linux_firewall</a> (self)</td></tr>
<tr class="separator:a25a8d6261c2514280dfbb67638bd1c9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a985fcea7e0ebd4e18002b398ebf5f3ff"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc7/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module.html#a985fcea7e0ebd4e18002b398ebf5f3ff">delete_slipsBlocking_chain</a> (self)</td></tr>
<tr class="separator:a985fcea7e0ebd4e18002b398ebf5f3ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12f7ae326da920f1d16d5cc82417080f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc7/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module.html#a12f7ae326da920f1d16d5cc82417080f">get_cmd_output</a> (self, command)</td></tr>
<tr class="separator:a12f7ae326da920f1d16d5cc82417080f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a7d1db04777899e6abfc8726a139fdc"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc7/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module.html#a6a7d1db04777899e6abfc8726a139fdc">initialize_chains_in_firewall</a> (self)</td></tr>
<tr class="separator:a6a7d1db04777899e6abfc8726a139fdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a159866a9dd15108bccbc772b2e43bcc4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc7/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module.html#a159866a9dd15108bccbc772b2e43bcc4">exec_iptables_command</a> (self, action, ip_to_block, flag, options)</td></tr>
<tr class="separator:a159866a9dd15108bccbc772b2e43bcc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a342a984517a1142124248c8c109fb2d9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc7/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module.html#a342a984517a1142124248c8c109fb2d9">is_ip_blocked</a> (self, ip)</td></tr>
<tr class="separator:a342a984517a1142124248c8c109fb2d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbf365e1845ab0c4c73295a99a5a87b8"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc7/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module.html#abbf365e1845ab0c4c73295a99a5a87b8">block_ip</a> (self, ip_to_block=None, from_=True, to=True, dport=None, sport=None, protocol=None, block_for=False)</td></tr>
<tr class="separator:abbf365e1845ab0c4c73295a99a5a87b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97626abd1f9aaa5ee9d399b505c3568c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc7/classslips_1_1modules_1_1blocking_1_1blocking_1_1Module.html#a97626abd1f9aaa5ee9d399b505c3568c">unblock_ip</a> (self, ip_to_unblock, from_=None, to=None, dport=None, sport=None, protocol=None)</td></tr>
<tr class="separator:a97626abd1f9aaa5ee9d399b505c3568c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94e6e17efc57d12cf21620df4392f127"><td class="memItemLeft" align="right" valign="top"><a id="a94e6e17efc57d12cf21620df4392f127"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>shutdown_gracefully</b> (self)</td></tr>
<tr class="separator:a94e6e17efc57d12cf21620df4392f127"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e7b4bb4962d2efbefdd39cf17b8b078"><td class="memItemLeft" align="right" valign="top"><a id="a3e7b4bb4962d2efbefdd39cf17b8b078"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>run</b> (self)</td></tr>
<tr class="separator:a3e7b4bb4962d2efbefdd39cf17b8b078"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:acaa2b719ffe5a507ac13c009912529d2"><td class="memItemLeft" align="right" valign="top"><a id="acaa2b719ffe5a507ac13c009912529d2"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>outputqueue</b></td></tr>
<tr class="separator:acaa2b719ffe5a507ac13c009912529d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20e82f46a98a87e6e278de2439a5431e"><td class="memItemLeft" align="right" valign="top"><a id="a20e82f46a98a87e6e278de2439a5431e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>c1</b></td></tr>
<tr class="separator:a20e82f46a98a87e6e278de2439a5431e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af95ea167587625fe4cef1c7403c2f2f8"><td class="memItemLeft" align="right" valign="top"><a id="af95ea167587625fe4cef1c7403c2f2f8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>os</b></td></tr>
<tr class="separator:af95ea167587625fe4cef1c7403c2f2f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae892ab2a92a086d3eb3bbc8447c094cf"><td class="memItemLeft" align="right" valign="top"><a id="ae892ab2a92a086d3eb3bbc8447c094cf"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>firewall</b></td></tr>
<tr class="separator:ae892ab2a92a086d3eb3bbc8447c094cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae89d5873b8c8a9579ceafd15a4f6bca6"><td class="memItemLeft" align="right" valign="top"><a id="ae89d5873b8c8a9579ceafd15a4f6bca6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>unblock_ips</b></td></tr>
<tr class="separator:ae89d5873b8c8a9579ceafd15a4f6bca6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf169e71523c2e166e628961b7ce73be"><td class="memItemLeft" align="right" valign="top"><a id="aaf169e71523c2e166e628961b7ce73be"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>running_in_docker</b></td></tr>
<tr class="separator:aaf169e71523c2e166e628961b7ce73be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5df5fcdd5aa4e277cff75bccd97c3f29"><td class="memItemLeft" align="right" valign="top"><a id="a5df5fcdd5aa4e277cff75bccd97c3f29"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>sudo</b></td></tr>
<tr class="separator:a5df5fcdd5aa4e277cff75bccd97c3f29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a5b707f25bcc5db3bea7acb265d19d0f7"><td class="memItemLeft" align="right" valign="top"><a id="a5b707f25bcc5db3bea7acb265d19d0f7"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>name</b> = 'Blocking'</td></tr>
<tr class="separator:a5b707f25bcc5db3bea7acb265d19d0f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a442b70c6c55a35e349b6e4da684c8213"><td class="memItemLeft" align="right" valign="top"><a id="a442b70c6c55a35e349b6e4da684c8213"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>description</b> = 'Block malicious IPs connecting to this device'</td></tr>
<tr class="separator:a442b70c6c55a35e349b6e4da684c8213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a940f1a1f2ce754ecf6b03fd075a64c91"><td class="memItemLeft" align="right" valign="top"><a id="a940f1a1f2ce754ecf6b03fd075a64c91"></a>
list&#160;</td><td class="memItemRight" valign="bottom"><b>authors</b> = ['Sebastian Garcia, Alya Gomaa']</td></tr>
<tr class="separator:a940f1a1f2ce754ecf6b03fd075a64c91"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Data should be passed to this module as a json encoded python dict,
by default this module flushes all slipsBlocking chains before it starts</pre> </div><h2 class="groupheader">Member Function Documentation</h2>
<a id="abbf365e1845ab0c4c73295a99a5a87b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbf365e1845ab0c4c73295a99a5a87b8">&#9670;&nbsp;</a></span>block_ip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.blocking.blocking.Module.block_ip </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ip_to_block</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>from_</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>to</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dport</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sport</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>protocol</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>block_for</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This function determines the user's platform and firewall and calls
the appropriate function to add the rules to the used firewall.
By default this function blocks all traffic from and to the given ip.
</pre> 
</div>
</div>
<a id="a985fcea7e0ebd4e18002b398ebf5f3ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a985fcea7e0ebd4e18002b398ebf5f3ff">&#9670;&nbsp;</a></span>delete_slipsBlocking_chain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.blocking.blocking.Module.delete_slipsBlocking_chain </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Flushes and deletes everything in slipsBlocking chain</pre> 
</div>
</div>
<a id="a25a8d6261c2514280dfbb67638bd1c9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25a8d6261c2514280dfbb67638bd1c9b">&#9670;&nbsp;</a></span>determine_linux_firewall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.blocking.blocking.Module.determine_linux_firewall </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the currently installed firewall and installs iptables if none was found</pre> 
</div>
</div>
<a id="a159866a9dd15108bccbc772b2e43bcc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a159866a9dd15108bccbc772b2e43bcc4">&#9670;&nbsp;</a></span>exec_iptables_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.blocking.blocking.Module.exec_iptables_command </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ip_to_block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Constructs the iptables rule/command based on the options sent in the message
flag options:
  -s : to block traffic from source ip
  -d : to block to destination ip
action options:
  insert : to insert a new rule at the top of slipsBlocking list
  delete : to delete an existing rule
</pre> 
</div>
</div>
<a id="a12f7ae326da920f1d16d5cc82417080f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12f7ae326da920f1d16d5cc82417080f">&#9670;&nbsp;</a></span>get_cmd_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.blocking.blocking.Module.get_cmd_output </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>command</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Executes a command and returns the output</pre> 
</div>
</div>
<a id="a6a7d1db04777899e6abfc8726a139fdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a7d1db04777899e6abfc8726a139fdc">&#9670;&nbsp;</a></span>initialize_chains_in_firewall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.blocking.blocking.Module.initialize_chains_in_firewall </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">For linux: Adds a chain to iptables or a table to nftables called
slipsBlocking where all the rules will reside</pre> 
</div>
</div>
<a id="a342a984517a1142124248c8c109fb2d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a342a984517a1142124248c8c109fb2d9">&#9670;&nbsp;</a></span>is_ip_blocked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool slips.modules.blocking.blocking.Module.is_ip_blocked </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Checks if ip is already blocked or not</pre> 
</div>
</div>
<a id="a3ebac44a0c55f89230d22ad1a917eb68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ebac44a0c55f89230d22ad1a917eb68">&#9670;&nbsp;</a></span>print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.blocking.blocking.Module.print </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>debug</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Function to use to print text using the outputqueue of slips.
Slips then decides how, when and where to print this text by taking all the processes into account
:param verbose:
    0 - don't print
    1 - basic operation/proof of work
    2 - log I/O operations and filenames
    3 - log database/profile/timewindow changes
:param debug:
    0 - don't print
    1 - print exceptions
    2 - unsupported and unhandled types (cases that may cause errors)
    3 - red warnings that needs examination - developer warnings
:param text: text to print. Can include format like 'Test {}'.format('here')
</pre> 
</div>
</div>
<a id="aa72921bb9ddfbb94a568184a10c07b1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa72921bb9ddfbb94a568184a10c07b1e">&#9670;&nbsp;</a></span>set_sudo_according_to_env()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.blocking.blocking.Module.set_sudo_according_to_env </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check if running in host or in docker and sets sudo string accordingly.
There's no sudo in docker so we need to execute all commands without it
</pre> 
</div>
</div>
<a id="acdbeb350740b00e84bab990e74c9efba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdbeb350740b00e84bab990e74c9efba">&#9670;&nbsp;</a></span>test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.blocking.blocking.Module.test </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">For debugging purposes, once we're done with the module we'll delete it</pre> 
</div>
</div>
<a id="a97626abd1f9aaa5ee9d399b505c3568c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97626abd1f9aaa5ee9d399b505c3568c">&#9670;&nbsp;</a></span>unblock_ip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.blocking.blocking.Module.unblock_ip </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ip_to_unblock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>from_</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>to</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dport</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sport</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>protocol</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Unblocks an ip based on the flags passed in the message</pre> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/alya/Desktop/slips/modules/blocking/blocking.py</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
